!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SWO=t():e.SWO=t()}(this,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,s(o.key),o)}}function s(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}e.d(t,{default:()=>a});var i=function(){return e=function e(t,n){var o,s;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof t||t instanceof HTMLElement?(o="string"==typeof t?document.querySelector(t):t,s=n||{}):(s=t||{},o=document.querySelector("[data-swo]")),o){this.targetElement=o,this.targetElement.classList.add("swo-container");var i="swo-instance-".concat(Math.random().toString(36).substring(2,9));this.options={code:s.code||this.targetElement.dataset.swoCode||this._getDefaultInitialCode(),storageKey:s.storageKey||this.targetElement.dataset.swoStorageKey||"senangwebs-one-editor-content-".concat(i)},this.elements={},this.cmEditor=null,this.isResizingPanes=!1,this.isResizingConsole=!1,this._createUI(),this._cacheElements(),this._initCodeMirror(),this._initEventListeners(),this._initialLayout(),this._loadCode(),this.updatePreview()}else console.error("SWO: Target element not found. Please provide a valid selector, DOM element, or ensure a [data-swo] element exists.")},t=[{key:"_createUI",value:function(){this.targetElement.innerHTML='\n            <div class="swo-main-wrapper">\n                <section class="swo-panel-editor-preview">\n                    <div class="swo-editor-pane">\n                        <div class="swo-editor-codemirror-container">\n                            <textarea class="swo-code-editor-textarea"></textarea>\n                        </div>\n                        <button class="swo-code-prettier-btn">PRETTIER</button>\n                    </div>\n            \n                    <div class="swo-resize-handle"></div>\n            \n                    <div class="swo-right-pane">\n                        <div class="swo-preview-pane-container">\n                            <div class="swo-preview-devices-container">\n                                <iframe class="swo-preview-frame" sandbox="allow-scripts allow-popups allow-forms allow-same-origin"></iframe>\n                            </div>\n                        </div>\n\n                        <div class="swo-resize-handle-console"></div>\n            \n                        <div class="swo-console-container">\n                            <div class="swo-console-header">\n                                <span class="swo-console-title">Console</span>\n                                <button class="swo-clear-console-btn">Clear</button>\n                            </div>\n                            <div class="swo-console-output"></div>\n                        </div>\n            \n                        <div class="swo-preview-frame-cover-resizeable"></div>\n                    </div>\n                </section>\n                <section class="swo-panel-control">\n                    <div class="swo-panel-control-group-left">\n                        <button class="swo-control-button swo-resize-desktop" title="Desktop View"><i class="fas fa-desktop"></i></button>\n                        <button class="swo-control-button swo-resize-tablet" title="Tablet View"><i class="fas fa-tablet-alt"></i></button>\n                        <button class="swo-control-button swo-resize-mobile" title="Mobile View"><i class="fas fa-mobile-alt"></i></button>\n                    </div>\n                    <div class="swo-panel-control-group-center">\n                        <button class="swo-control-button swo-refresh-preview" title="Refresh Preview"><i class="fas fa-sync-alt"></i></button>                \n                    </div>\n                    <div class="swo-panel-control-group-right">\n                        <button class="swo-control-button swo-toggle-code-editor-btn" title="Toggle Code Editor"><i class="fas fa-code"></i></button>\n                        <button class="swo-control-button swo-toggle-console-btn" title="Toggle Console"><i class="fas fa-terminal"></i></button>\n                        <button class="swo-control-button swo-open-new-tab" title="Open in New Tab"><i class="fas fa-bolt"></i></button>\n                    </div>\n                </section>\n            </div>\n        '}},{key:"_cacheElements",value:function(){var e=this.elements,t=this.targetElement;e.editorPane=t.querySelector(".swo-editor-pane"),e.codeEditorTextarea=t.querySelector(".swo-code-editor-textarea"),e.codePrettierBtn=t.querySelector(".swo-code-prettier-btn"),e.resizeHandle=t.querySelector(".swo-resize-handle"),e.rightPane=t.querySelector(".swo-right-pane"),e.previewPaneContainer=t.querySelector(".swo-preview-pane-container"),e.previewDevicesContainer=t.querySelector(".swo-preview-devices-container"),e.previewFrame=t.querySelector(".swo-preview-frame"),e.resizeHandleConsole=t.querySelector(".swo-resize-handle-console"),e.consoleContainer=t.querySelector(".swo-console-container"),e.consoleOutput=t.querySelector(".swo-console-output"),e.clearConsoleBtn=t.querySelector(".swo-clear-console-btn"),e.previewFrameCover=t.querySelector(".swo-preview-frame-cover-resizeable"),e.toggleCodeEditorBtn=t.querySelector(".swo-toggle-code-editor-btn"),e.toggleConsoleBtn=t.querySelector(".swo-toggle-console-btn"),e.resizeDesktopBtn=t.querySelector(".swo-resize-desktop"),e.resizeTabletBtn=t.querySelector(".swo-resize-tablet"),e.resizeMobileBtn=t.querySelector(".swo-resize-mobile"),e.refreshPreviewBtn=t.querySelector(".swo-refresh-preview"),e.openNewTabBtn=t.querySelector(".swo-open-new-tab"),e.codeEditorUIElements=t.querySelectorAll(".swo-editor-pane, .swo-resize-handle"),e.consoleUIElements=t.querySelectorAll(".swo-console-container, .swo-resize-handle-console")}},{key:"_initCodeMirror",value:function(){var e,t=this;if("undefined"==typeof CodeMirror)return console.error("SWO: CodeMirror library not found. Please include CodeMirror."),void(this.elements.codeEditorTextarea.value="CodeMirror not loaded. Please include it.");this.cmEditor=CodeMirror.fromTextArea(this.elements.codeEditorTextarea,{mode:"htmlmixed",theme:"hopscotch",lineNumbers:!0,autoCloseTags:!0,autoCloseBrackets:!0,matchBrackets:!0,tabSize:2,indentUnit:2}),this.cmEditor.on("change",(function(){t._saveCode(t.cmEditor.getValue()),clearTimeout(e),e=setTimeout((function(){return t.updatePreview()}),300)}))}},{key:"_initEventListeners",value:function(){var e=this,t=this.elements;t.codePrettierBtn&&("function"==typeof html_beautify?t.codePrettierBtn.addEventListener("click",(function(){return e.formatCode()})):(t.codePrettierBtn.disabled=!0,t.codePrettierBtn.title="Formatting library (js-beautify) not loaded",console.warn('SWO: html_beautify function not found. The "Prettier" button will be disabled.'))),t.resizeHandle.addEventListener("mousedown",this._onPaneResizeMouseDown.bind(this)),t.resizeHandleConsole.addEventListener("mousedown",this._onConsoleResizeMouseDown.bind(this)),t.clearConsoleBtn.addEventListener("click",(function(){return e._clearConsoleOutput(!0)})),t.resizeDesktopBtn.addEventListener("click",(function(){return e.resizePreviewDevice("100%","100%")})),t.resizeTabletBtn.addEventListener("click",(function(){return e.resizePreviewDevice("1070px","100%")})),t.resizeMobileBtn.addEventListener("click",(function(){return e.resizePreviewDevice("390px","844px")})),t.refreshPreviewBtn.addEventListener("click",(function(){return e.updatePreview()})),t.openNewTabBtn.addEventListener("click",(function(){return e.openPreviewInNewTab()})),t.toggleCodeEditorBtn.addEventListener("click",(function(){return e.toggleCodeEditor()})),t.toggleConsoleBtn.addEventListener("click",(function(){return e.toggleConsole()})),window.addEventListener("message",this._handleIframeMessage.bind(this))}},{key:"_initialLayout",value:function(){this.elements.editorPane.style.width="calc(50% - 0.25rem)",this.elements.consoleUIElements.forEach((function(e){return e.classList.add("swo-hidden")})),this._updateButtonActiveState(this.elements.toggleConsoleBtn,!1),this.elements.previewPaneContainer.style.height="".concat(this.elements.rightPane.offsetHeight,"px"),this._updateButtonActiveState(this.elements.toggleCodeEditorBtn,!0)}},{key:"_loadCode",value:function(){var e=localStorage.getItem(this.options.storageKey),t=null!==e?e:this.options.code;this.cmEditor?(this.cmEditor.setValue(t),this.cmEditor.clearHistory()):this.elements.codeEditorTextarea.value=t}},{key:"_saveCode",value:function(e){localStorage.setItem(this.options.storageKey,e)}},{key:"_getIframeConsoleBridgeScript",value:function(){return"\n<script id=\"iframe-console-bridge\">\n(function() {\n    'use strict';\n    if (window.parent === window) return; // Don't run if not in an iframe or if it's top window\n\n    const originalConsole = {};\n    const methods = ['log', 'error', 'warn', 'info', 'debug', 'clear'];\n    methods.forEach(method => {\n        originalConsole[method] = console[method] ? console[method].bind(console) : () => {};\n    });\n\n    function formatArgsForPostMessage(args) {\n        return Array.from(args).map(arg => {\n            if (arg instanceof Error) return `Error: ${arg.message}${arg.stack ? `\\nStack: ${arg.stack}` : ''}`;\n            if (arg instanceof HTMLElement) {\n                let attrs = Array.from(arg.attributes).map(attr => `${attr.name}=\"${attr.value}\"`).join(' ');\n                return `<${arg.tagName.toLowerCase()}${attrs ? ' ' + attrs : ''}>...`;\n            }\n            if (typeof arg === 'function') return '[Function]';\n            if (typeof arg === 'symbol') return arg.toString();\n            // Basic object serialization, trying to catch circular refs\n            if (typeof arg === 'object' && arg !== null) {\n                try {\n                    const cache = new Set();\n                    return JSON.stringify(arg, (key, value) => {\n                        if (typeof value === 'object' && value !== null) {\n                            if (cache.has(value)) return '[Circular Reference]';\n                            cache.add(value);\n                        }\n                        if (value instanceof HTMLElement) return `<${value.tagName.toLowerCase()}> (embedded HTML Element)`;\n                        return value;\n                    }, 2);\n                } catch (e) { return '[Unserializable Object]'; }\n            }\n            return String(arg);\n        });\n    }\n\n    methods.forEach(methodName => {\n        if (methodName === 'clear') {\n            console.clear = function() {\n                originalConsole.clear();\n                try { window.parent.postMessage({ type: 'iframe-console', method: 'clear' }, '*'); }\n                catch(e) { originalConsole.error('SWO Console bridge error (clear):', e); }\n            };\n        } else {\n            console[methodName] = function(...args) {\n                originalConsole[methodName](...args);\n                try { window.parent.postMessage({ type: 'iframe-console', method: methodName, args: formatArgsForPostMessage(args) }, '*'); }\n                catch(e) { originalConsole.error('SWO Console bridge error ('+methodName+'):', e); }\n            };\n        }\n    });\n\n    window.addEventListener('error', function(event) {\n        const errorArgs = [`Unhandled error: ${event.message}`, `at ${event.filename || 'unknown'}:${event.lineno || 0}:${event.colno || 0}`];\n        originalConsole.error(...errorArgs);\n        try { window.parent.postMessage({ type: 'iframe-console', method: 'error', args: errorArgs }, '*'); }\n        catch(e) { originalConsole.error('SWO Console bridge error (onerror):', e); }\n    });\n\n    window.addEventListener('unhandledrejection', function(event) {\n        const reason = event.reason instanceof Error ? `${event.reason.message}\\n${event.reason.stack}` : String(event.reason);\n        const rejectionArgs = ['Unhandled promise rejection:', reason];\n        originalConsole.warn(...rejectionArgs);\n        try { window.parent.postMessage({ type: 'iframe-console', method: 'warn', args: rejectionArgs }, '*'); }\n        catch(e) { originalConsole.error('SWO Console bridge error (unhandledrejection):', e); }\n    });\n    \n    // Notify parent that bridge is ready\n    setTimeout(() => {\n        try { \n            window.parent.postMessage({ type: 'iframe-ready' }, '*');\n            originalConsole.log(\"SWO Console bridge initialized in iframe.\");\n        } catch(e) { originalConsole.error('SWO Console bridge error (ready):', e); }\n    }, 0);\n})();\n<\/script>\n"}},{key:"updatePreview",value:function(){if(this.elements.previewFrame){var e=this.cmEditor?this.cmEditor.getValue():this.elements.codeEditorTextarea.value,t=this._getIframeConsoleBridgeScript()+e;this.elements.previewFrame.src="data:text/html;charset=utf-8,"+encodeURIComponent(t)}}},{key:"openPreviewInNewTab",value:function(){var e=this.cmEditor?this.cmEditor.getValue():this.elements.codeEditorTextarea.value,t=this._getIframeConsoleBridgeScript()+e,n=new Blob([t],{type:"text/html"}),o=URL.createObjectURL(n),s=window.open(o,"_blank");setTimeout((function(){URL.revokeObjectURL(o)}),5e3),s||(URL.revokeObjectURL(o),alert("Popup blocked! Please allow popups for this site to open the preview in a new tab."))}},{key:"resizePreviewDevice",value:function(e,t){this.elements.previewDevicesContainer&&(this.elements.previewDevicesContainer.style.maxWidth=e,this.elements.previewDevicesContainer.style.height=t,this.elements.previewDevicesContainer.style.margin="100%"!==e?"auto":"")}},{key:"toggleConsole",value:function(){var e=this.elements,t=!e.consoleContainer.classList.contains("swo-hidden");e.consoleUIElements.forEach((function(e){e.classList.toggle("swo-hidden",t)}));var n=!t;this._updateButtonActiveState(e.toggleConsoleBtn,n);var o=e.rightPane.offsetHeight,s=e.resizeHandleConsole.offsetHeight;n?(e.previewPaneContainer.style.height="".concat(.66*(o-s),"px"),e.consoleContainer.style.height="".concat(.34*(o-s),"px")):e.previewPaneContainer.style.height="".concat(o,"px")}},{key:"toggleCodeEditor",value:function(){var e=this.elements,t=!1;e.codeEditorUIElements.forEach((function(n){var o=n.classList.contains("swo-hidden");n.classList.toggle("swo-hidden",!o),n===e.editorPane&&o?t=!0:n!==e.editorPane||o||(t=!1)})),this._updateButtonActiveState(e.toggleCodeEditorBtn,t)}},{key:"formatCode",value:function(){if("function"==typeof html_beautify&&this.cmEditor){var e=this.cmEditor.getValue(),t={wrap_line_length:120,indent_with_tabs:this.cmEditor.getOption("indentWithTabs"),indent_size:this.cmEditor.getOption("indentUnit")||2,indent_char:this.cmEditor.getOption("indentWithTabs")?"\t":" "};try{var n=html_beautify(e,t);this.cmEditor.setValue(n)}catch(e){console.error("SWO: Error during code formatting with js-beautify:",e),alert("Could not format the code. Check console for errors.")}}}},{key:"_handleIframeMessage",value:function(e){if(e.source===this.elements.previewFrame.contentWindow&&e.data){var t=e.data;if("iframe-console"===t.type){var n=document.createElement("div");n.classList.add("swo-console-message-line");var o="swo-console-log",s="➡️";switch(t.method){case"error":o="swo-console-error",s="❌";break;case"warn":o="swo-console-warn",s="⚠️";break;case"info":o="swo-console-info",s="ℹ️";break;case"debug":o="swo-console-debug",s="🐞";break;case"clear":return this._clearConsoleOutput(!1),void this._logSpecialMessageToConsole("Console cleared by iframe.","swo-console-cleared")}n.classList.add(o);var i=document.createElement("span");i.className="swo-console-message-icon",i.textContent=s,n.appendChild(i);var r=document.createElement("div");if(r.className="swo-console-message-content-wrapper",t.args&&t.args.length>0){var a=document.createElement("pre");a.className="swo-console-message-content",a.textContent=t.args.join(" "),r.appendChild(a)}else{var l=document.createElement("span");l.textContent="log"===t.method?"(empty log)":"(".concat(t.method," with no arguments)"),l.style.opacity="0.7",l.style.fontStyle="italic",r.appendChild(l)}n.appendChild(r),this.elements.consoleOutput.appendChild(n),this.elements.consoleOutput.scrollTop=this.elements.consoleOutput.scrollHeight}else"iframe-ready"===t.type&&this._logSpecialMessageToConsole("Console connected.","swo-console-connected")}}},{key:"_clearConsoleOutput",value:function(e){this.elements.consoleOutput.innerHTML="",e&&this._logSpecialMessageToConsole("Console cleared by editor.","swo-console-cleared")}},{key:"_logSpecialMessageToConsole",value:function(e,t){var n=document.createElement("div");n.className="swo-console-special-message ".concat(t),n.textContent=e,this.elements.consoleOutput.appendChild(n),this.elements.consoleOutput.scrollTop=this.elements.consoleOutput.scrollHeight}},{key:"_updateButtonActiveState",value:function(e,t){e&&(t?e.classList.add("swo-active"):e.classList.remove("swo-active"))}},{key:"_onPaneResizeMouseDown",value:function(e){e.preventDefault(),this.isResizingPanes=!0,this._initialMouseX=e.clientX,this._initialEditorWidth=this.elements.editorPane.offsetWidth,this.elements.previewFrameCover.classList.remove("swo-hidden"),document.body.style.cursor="col-resize",document.body.style.userSelect="none",this._boundHandlePaneMouseMove=this._handlePaneMouseMove.bind(this),this._boundHandlePaneMouseUp=this._handlePaneMouseUp.bind(this),document.addEventListener("mousemove",this._boundHandlePaneMouseMove),document.addEventListener("mouseup",this._boundHandlePaneMouseUp)}},{key:"_handlePaneMouseMove",value:function(e){if(this.isResizingPanes){var t=e.clientX-this._initialMouseX,n=this._initialEditorWidth+t,o=this.elements.editorPane.parentElement.offsetWidth,s=this.elements.resizeHandle.offsetWidth,i=Math.max(100,.15*o);n=Math.max(i,Math.min(n,o-i-s)),this.elements.editorPane.style.width="".concat(n,"px")}}},{key:"_handlePaneMouseUp",value:function(){this.isResizingPanes&&(this.isResizingPanes=!1,this.elements.previewFrameCover.classList.add("swo-hidden"),document.body.style.cursor="default",document.body.style.userSelect="",document.removeEventListener("mousemove",this._boundHandlePaneMouseMove),document.removeEventListener("mouseup",this._boundHandlePaneMouseUp))}},{key:"_onConsoleResizeMouseDown",value:function(e){e.preventDefault(),this.isResizingConsole=!0,this._initialMouseYConsole=e.clientY,this._initialPreviewHeight=this.elements.previewPaneContainer.offsetHeight,this.elements.previewFrameCover.classList.remove("swo-hidden"),document.body.style.cursor="row-resize",document.body.style.userSelect="none",this._boundHandleConsoleResizeMouseMove=this._handleConsoleResizeMouseMove.bind(this),this._boundHandleConsoleResizeMouseUp=this._handleConsoleResizeMouseUp.bind(this),document.addEventListener("mousemove",this._boundHandleConsoleResizeMouseMove),document.addEventListener("mouseup",this._boundHandleConsoleResizeMouseUp)}},{key:"_handleConsoleResizeMouseMove",value:function(e){if(this.isResizingConsole){var t=e.clientY-this._initialMouseYConsole,n=this._initialPreviewHeight+t,o=this.elements.rightPane.offsetHeight,s=this.elements.resizeHandleConsole.offsetHeight,i=Math.max(50,.1*o),r=o-(n=Math.max(i,Math.min(n,o-i-s)))-s;this.elements.previewPaneContainer.style.height="".concat(n,"px"),this.elements.consoleContainer.style.height="".concat(r,"px")}}},{key:"_handleConsoleResizeMouseUp",value:function(){this.isResizingConsole&&(this.isResizingConsole=!1,this.elements.previewFrameCover.classList.add("swo-hidden"),document.body.style.cursor="default",document.body.style.userSelect="",document.removeEventListener("mousemove",this._boundHandleConsoleResizeMouseMove),document.removeEventListener("mouseup",this._boundHandleConsoleResizeMouseUp))}},{key:"_getDefaultInitialCode",value:function(){return'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Live Preview</title>\n    <style>\n        body { font-family: sans-serif; background-color: #f0f0f0; color: #333; padding: 20px; margin: 0; }\n        h1 { color: steelblue; }\n        button { background-color: steelblue; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; margin-top: 10px; }\n        button:hover { background-color: darkslateblue; }\n        .output { margin-top: 10px; padding: 10px; border: 1px solid #ccc; background-color: #fff; min-height: 20px; }\n        .note { font-size: 0.9em; color: #555; margin-top:15px; }\n    </style>\n</head>\n<body>\n    <h1>Hello SenangWebs One!</h1>\n    <p>This is a live preview. Edit the code on the left. Check the console for messages.</p>\n    <button id="testBtn">Log Message</button>\n    <button id="errorBtn">Log Error</button>\n    <div id="outputDiv" class="output"></div>\n    <p class="note">Open your browser\'s developer console to see original logs too.</p>\n    <script>\n        console.log("Iframe script loaded!", { a: 1, b: "text" });\n        console.warn("This is a warning from iframe.");\n        const testBtn = document.getElementById(\'testBtn\');\n        const errorBtn = document.getElementById(\'errorBtn\');\n        const outputDiv = document.getElementById(\'outputDiv\');\n        let clickCount = 0;\n        if (testBtn) {\n            testBtn.addEventListener(\'click\', () => {\n                clickCount++;\n                const complexObject = { id: clickCount, timestamp: new Date(), nested: { data: [1,2,3] } };\n                console.log("Button clicked:", clickCount, "times.", complexObject);\n                if(outputDiv) outputDiv.textContent = "Logged to SWO console. Click: " + clickCount;\n            });\n        }\n        if (errorBtn) {\n            errorBtn.addEventListener(\'click\', () => {\n                console.error("This is a test error!", new Error("Something went wrong in iframe"));\n            });\n        }\n        // Test unhandled error\n        // setTimeout(() => { throw new Error("Test unhandled error from iframe"); }, 2000);\n        // Test unhandled promise rejection\n        // Promise.reject("Test unhandled promise rejection from iframe");\n    <\/script>\n</body>\n</html>'}},{key:"destroy",value:function(){window.removeEventListener("message",this._handleIframeMessage.bind(this)),this.cmEditor&&this.cmEditor.toTextArea(),this.targetElement.innerHTML="",this.targetElement.classList.remove("swo-container"),this.elements={},this.cmEditor=null,delete this.targetElement.swoInstance}}],t&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function r(){document.querySelectorAll("[data-swo]").forEach((function(e){e.swoInstance||(e.swoInstance=new i(e,{}))}))}"undefined"!=typeof window&&("complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?r():document.addEventListener("DOMContentLoaded",r));const a=i;return t.default})()));